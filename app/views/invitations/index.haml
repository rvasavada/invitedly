.container
  %h2
    .pull-right
      %button.btn.btn-success{"data-target" => "#myModal", "data-toggle" => "modal"} Import from CSV
      =link_to "New Invitation", new_occasion_invitation_path(@occasion), class: "btn btn-success"
    Invitations
    %small.text-muted="(#{pluralize(@invitations.count, 'invitations')} found)"
    
  
  - if @invitations.present?
    .panel.panel-default
      %ul.list-group
        %li.list-group-item
          .pull-right
            %strong Download:
            = link_to "CSV", occasion_invitations_path(@occasion, format: "csv")
        
          %ul.list-inline
            %li.text-success
              %strong=@invitations.where(:status => "Responded").count
              Responded
            %li
              %strong=@invitations.where(:status => "Not Sent/Modified").count
              Not Sent/Modified
            %li
              %strong=@invitations.where(:status => "Not Responded").count
              Not Responded

        %table.table.table-condensed#invitation_guest
          %thead
            %tr
              %th{colspan: 2} Invitation name
              %th Status       
              %th Last updated
              %th Actions
          %tbody
            - @invitations.each do |invitation|
              %tr.record_row{id: invitation.id}
                %td
                  %span.glyphicon.glyphicon-chevron-right.small{id: "no_detail#{invitation.id}"}
                  %span.glyphicon.glyphicon-chevron-down.small{style:"display:none", id: "yes_detail#{invitation.id}"}
                %td{id: "invitation_name#{invitation.id}"}
                  = invitation.name
              
                  - invitation.tags.each do |t| 
                    %span.label.label-primary=t
        
                %td
                  = invitation.status
                %td
                  %small.text-muted=" #{time_ago_in_words(invitation.updated_at)} ago"
                %td
                  %div{id:"record_actions#{invitation.id}",style:"display:none;"}
                    = link_to occasion_invitation_manage_path(@occasion,invitation, :guest_info), data: {title: "Edit Invitation", placement: "bottom", trigger: "hover"}, rel: "tooltip", class: "btn btn-link btn-sm" do
                      %span.glyphicon.glyphicon-pencil
                    = link_to "#", data: {title: "Send Invitation", placement: "bottom", trigger: "hover"}, rel: "tooltip", class: "btn btn-link btn-sm" do
                      %span.glyphicon.glyphicon-envelope
                    
                    = link_to occasion_invitation_path(@occasion,invitation), method: :delete, data: {title: "Delete Invitation", placement: "bottom", trigger: "hover"},rel: "tooltip", confirm: 'Are you sure you want to delete this invitation?', class: "btn btn-link btn-sm", style: "color:#E41313;"  do
                      %span.glyphicon.glyphicon-trash
              %tr.edit_row{style: "display:none;", id: "edit_row#{invitation.id}"}
                %td{colspan:5, style: "border-top:0px;"}
                  .row
                    .col-md-4
                      .well.well-sm{style:"background-color:#fff;"}
                        %p.text-muted.small  Guests
                        - invitation.guests.each do |guest|
                          =guest.full_name
                          %br
                    .col-md-4
                      .well.well-sm{style:"background-color:#fff;"}
                        %p.text-muted.small  Contact Info
                        = invitation.email
                    .col-md-4
                      .well.well-sm{style:"background-color:#fff;"}
                        %p.text-muted.small Private Notes
                        =invitation.notes
  - else
    %ul.list-group
      %li.list-group-item.text-center
        %h3
          %strong You haven't invited any guests yet!
          =link_to "Create an invitation", new_occasion_invitation_path(@occasion), class: "btn btn-primary"

.modal.fade#myModal{:tabindex=> "-1", :role=>"dialog", "aria-labelledby"=>"myModalLabel", "aria-hidden"=> "true"}
  .modal-dialog
    .modal-content
      .modal-header
        %button.close{"aria-hidden" => "true", "data-dismiss" => "modal", type: "button"} Ã—
        %h2.modal-title
          %strong Import a CSV file of your guests
      .modal-body
        %h4 
          %strong 1.  Download this example template
        .form-group
          = link_to "https://docs.google.com/a/vasavada.us/spreadsheet/ccc?key=0Ar12fAF1l7BJdGZfRUdZMy1NaDhGNER6SU9TX1h2UlE#gid=0", target: :blank, class:"btn btn-primary" do        
            %span.glyphicon.glyphicon-new-window
            Example template
        %h4
          %strong 2. Import your CSV!
        =form_tag import_occasion_guests_path(@occasion), multipart: true do
          .row
            .col-sm-8
              .well.well-sm
                %strong= file_field_tag :file
            .col-sm-4
              = submit_tag "Import guests", :class => "btn btn-success"
        %hr
        %h4
          %strong Field Descriptions
        %small
          %dl
            %dt Tags
            %dd Comma separated words (e.g. Bride, Groom, Tier 1, etc.)
            %dt Family Name (optional)
            %dd If this is a family, add a family name else leave blank.  All guests under the same family name will be grouped together.
            %dt Email (optional)
            %dd Add email else leave blank.
          
            %dt Notes (optional)
            %dd Add any notes.  These notes will be kept private.
            %dt Title
            %dd This can be either Dr., Mr., Mrs., and Ms. If you don't know the guest's name, but would like to reserve a place for an additional guest, please leave title, first name, and last name blank.
            %dt First Name
            %dd This is the guest's first name. If you don't know the guest's name, but would like to reserve a place for an additional guest, please leave title, first name, and last name blank.
            %dt Last Name
            %dd This is the guest's last name. If you don't know the guest's name, but would like to reserve a place for an additional guest, please leave title, first name, and last name blank.
            %dt Events
            %dd
              For every event that has been created, add an additional column with the
              %strong exact
              event name in the header and "Y" to the events to which the guest is invited, else leave the fields blank.
