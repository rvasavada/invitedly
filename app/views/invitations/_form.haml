= form_for [@occasion,@invitation], :html => { :role => "form"} do |f|
      
  %fieldset.form-section
    %h4 Invitation Information
    %p Select a guest and the maximum number of people that the guest can bring.
    
    .row
      .col-xs-9
        .form-group
          = f.label :contact_id, "Guest name",class: "control-label"
          - if @invitation.contact_id.present?
            = f.collection_select :contact_id, @contacts, :id, :contact_name,{}, {:disabled => true, class: "form-control"}
          -else
            = f.collection_select :contact_id, @contacts, :id, :contact_name, {:prompt => "Please select a guest..."}, {class: "form-control"}
      .col-xs-3
        .form-group              
          = f.label :max_guests, "Max guests", class: "control-label"
          = f.select :max_guests, options_for_select((1..20).to_a),{}, class: "form-control"
    .checkbox        
      = f.label :send_email, class: "control-label" do
        = f.check_box :send_email, checked: true
        Send guest an email to rsvp?
    .row#invitation_send_date
      .col-xs-6
        = f.label :send_date, "Invitation Send Date"
        = f.text_field :send_date, :value => @invitation.send_date.blank? ?  Date.today.strftime("%b %e, %Y") : @invitation.send_date, :class => "datepicker form-control"
          
  %fieldset.form-section
    %h4 Event Information
    %p Select the events that this guest is invited to below.  You can also mark their response, if known.
    %table.table
      %thead
        %tr
          %th Event name
          %th Response
      %tbody
        = f.fields_for :rsvps do |rsvp|
          %tr
            %td
              = rsvp.hidden_field(:event_id)
              .checkbox
                = rsvp.check_box :visibility
                = rsvp.label :visibility, Event.find(rsvp.object.event_id).name, class: "control-label"
            %td
              .form-group
                = rsvp.collection_select(:response,	@response, :name, :name, {:selected => rsvp.object.response.blank? ? "Not Responded" : rsvp.object.response},class: "form-control")

  .pull-right
    = f.submit "Save & Invite more", :class => "btn btn-primary btn-lg"
    = f.submit "Save & Finish", :class => "btn btn-success btn-lg"
  = link_to 'Cancel', occasion_invitations_path(@occasion), :class=> "btn btn-default btn-lg"