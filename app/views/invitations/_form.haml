= form_for [@occasion,@invitation], :html => {:role =>"form"} do |f|
  .panel.panel-default
    .panel-body
      %legend Guest information
      = f.fields_for :household, @household do |household|
        .row
          .col-lg-9
            .form-group{class: @household.errors.include?(:name) ? 'has-error' : ''}
              %span.help-block
                %strong= @household.errors.get(:name).present? ? "Group name #{@household.errors.get(:name).join('; ')}" : ""
              = household.text_field :name, placeholder: "Group Name", :autofocus => true, :maxlength => 50, class: "form-control input-lg"
              %span.help-block
                This name is private and won't be shared with the guests.
          
            .form-group
              = household.label :guests, "Guest names"
              %span.help-block= "You can add unlimited guests.  Leave blank rows for every guest that you don't know the name of or for +1s."
              #guests
                = household.fields_for :guests, @household.guests do |guest|
                  = render 'guest_fields', :f => guest
                .form-group
                  = link_to_add_association 'Add Guest', household, :guests, :class => "btn btn-primary"
          
            .form-group
              = household.label :email, class: "control-label"
              = household.text_field :email, :maxlength => 50, class: "form-control"
              %span.help-block You can optionally add an email address.
        
            .form-group
              = household.label :notes, class: "control-label"
              = household.text_area :notes, {:rows => 5, :maxlength => 500, class: "form-control"}
              %span.help-block These notes are private and won't be shared with the guests.

  .form-group.pull-right
    = f.submit "Save", :class => "btn btn-success btn-lg"