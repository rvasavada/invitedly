= form_for [@occasion,@invitation], :html => {:role =>"form"} do |f|

  = f.fields_for :household, @household do |household|
    .panel.panel-default
      .panel-body
        %h2 Some basic information about the invitation
      
        %legend Guest Information
        
        .form-group{class: household.object.errors.include?(:name) ? 'has-error' : ''}
          = household.label :name, "Invitation Name", class: "control-label"
          = household.text_field :name, placeholder: "Invitation Name", :autofocus => true, :maxlength => 50, class: "form-control"
          - if household.object.errors.include?(:name)
            %span.help-block=household.object.errors.get(:name).join('; ')
          - else
            %span.help-block This name is private and won't be shared with the guests.
        
        = household.label :guests, "Guest Names", class: "control-label"
        %small (Guest names can be left blank for guests to fill out)
        #guests  
          = household.fields_for :guests do |guest|
            = render 'invitations/guest_fields', :f => guest
          .links
            = link_to_add_association 'Add Guest', household, :guests, :class => "btn btn-primary", :partial => 'invitations/guest_fields'
    
    .panel.panel-default
      .panel-body
        %legend Contact Information & Notes
        
        .row
          .col-lg-9
            .form-group
              = household.label :email, class: "control-label"
              = household.text_field :email, :maxlength => 50, class: "form-control"
              %span.help-block You can optionally add an email address.
    
            .form-group
              = household.label :notes, class: "control-label"
              = household.text_area :notes, {:rows => 5, :maxlength => 500, class: "form-control"}
              %span.help-block These notes are private and won't be shared with the guests.
          
            .form-group
              = household.label :tag_list, "Tags (separated by commas)"
              = household.text_field :tag_list, class: "form-control", :placeholder => "Bride, Groom, Tier 1, etc."

  .form-group.pull-right
    = f.submit "Next", :class => "btn btn-success btn-lg"