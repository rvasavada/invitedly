.container
  .row
    .col-sm-offset-2.col-sm-8
      %h2 
        .pull-right= link_to 'New Event', new_occasion_event_path(@occasion), class: "btn btn-primary"
        Events
    
  
      
      - if @events.present?
        - @events.each do |event|
          %ul.list-group
            %li.list-group-item
              .btn-group.pull-right
                %button.btn.btn-default.dropdown-toggle{"data-toggle" => "dropdown", type: "button"}
                  %span.glyphicon.glyphicon-cog
                  %span.caret
                %ul.dropdown-menu{role: "menu"}
                  %li= link_to "View guest list", occasion_event_path(@occasion,event)
                  %li= link_to "Edit event", edit_occasion_event_path(@occasion,event)
                  %li.divider
                  %li= link_to "Delete Event", occasion_event_path(@occasion,event), method: :delete, confirm: 'Are you sure you want to delete this event?'

              %h3=link_to event.name, occasion_event_path(@occasion,event), style: "color:#333;"
              
              .row
                .col-md-6
                  %p
                    %span.glyphicon.glyphicon-calendar{style:"font-size:1.25em;"}
                    = "#{event.start_date.strftime('%A, %B %e, %Y')} at #{event.start_time.strftime('%l:%M%P')}"
                  %p
                    %span.glyphicon.glyphicon-map-marker{style:"font-size:1.25em;"}
                    - unless event.address_1.blank?
                      = link_to "https://www.google.com/maps/preview#!q=#{event.address}" do
                        =event.location
                      %span.text-muted= "| #{event.address}"
                    - else
                      = event.location
                  %p=event.description
                .col-md-6
    
                  .progress
                    .progress-bar.progress-bar-success{style: "width: #{100*Rsvp.attending(event).count/(Rsvp.invited(event).count == 0 ? 1 : Rsvp.invited(event).count )}%"}
                      = "#{Rsvp.attending(event).count} attending"
                    .progress-bar.progress-bar-danger{style: "width: #{100*Rsvp.not_attending(event).count/(Rsvp.invited(event).count == 0 ? 1 : Rsvp.invited(event).count )}%"}
                      = "#{Rsvp.not_attending(event).count} not attending"
                    .progress-bar{style: "width: #{100*Rsvp.not_responded(event).count/(Rsvp.invited(event).count == 0 ? 1 : Rsvp.invited(event).count)}%"}
                      = "#{Rsvp.not_responded(event).count} not responded"
                  %ul
                    %li= "#{Rsvp.invited(event).count} invited"
                    %li= "#{Rsvp.attending(event).count} attending"
                    %li="#{Rsvp.not_attending(event).count} not attending"
                    %li= "#{Rsvp.not_responded(event).count} not responded"        

      -else
        %ul.list-group
          %li.list-group-item.text-center
            %h3
              You haven't added any events yet!