%nav.navbar.navbar-default{role: "navigation"}
  / Brand and toggle get grouped for better mobile display
  .navbar-header
    %button.navbar-toggle{"data-target" => "#bs-example-navbar-collapse-1", "data-toggle" => "collapse", type: "button"}
      %span.sr-only Toggle navigation
      %span.icon-bar
      %span.icon-bar
      %span.icon-bar
    %a.navbar-brand{href: "#"} Invitedly
  / Collect the nav links, forms, and other content for toggling
  #bs-example-navbar-collapse-1.collapse.navbar-collapse
    %ul.nav.navbar-nav
      - if user_signed_in? 
        - if current_user.occasion
          %li.active= link_to "Events", occasion_events_path(current_user.occasion)
          %li= link_to "Guests", occasion_contacts_path(current_user.occasion)
  

    %ul.nav.navbar-nav.navbar-right
      - if user_signed_in? 
        - if current_user.occasion
          %li.dropdown
            %a.dropdown-toggle{"data-toggle" => "dropdown", href: "#"}
              =current_user.occasion.name
  
              %b.caret
            %ul.dropdown-menu
              %li= link_to "Edit Wedding Details", edit_occasion_path(current_user.occasion)
              %li= link_to "Preview Wedding Page", occasion_path(current_user.occasion, :preview => "true")
        - else
          %li= link_to "New Wedding", new_occasion_path
      - if user_signed_in? 
        %li= link_to "Settings", edit_user_registration_path
        %li= link_to "Sign out", destroy_user_session_path, method: :delete
      -else
        %li= link_to "Sign in", new_user_session_path
        %li= link_to "Sign up", new_user_registration_path

%h1 
  .pull-right= link_to 'New Event', new_occasion_event_path(@occasion), class: "btn btn-success"
  Events


- if @events.present?

  %table.table
    %tbody
    - @events.each do |event|
      %tr
        %td
        
          %h3=event.name
          %p
            %strong= "#{event.start_date.strftime('%A, %B %e, %Y')} at #{event.start_time}"
            %br
            = link_to event.location, "https://www.google.com/maps/preview#!q=#{event.address}"
            -if event.address_1.present?
              | 
              ="#{event.address_1} #{event.address_2}"
            -if ((event.city.present? and event.state.present?) and (event.country == 'United States'))
              ="#{event.city}, #{event.state} #{event.zip}" 
            -if ((event.city.present? and event.region.present?) and (event.country != 'United States'))
              ="#{event.city}, #{event.region} #{event.postal_code}"
            -if event.country != 'United States'
              = event.country
          %p
            .text-muted
              =event.description
              %span=link_to "edit", edit_occasion_event_path(@occasion,event)


-else
  .well.text-center
    %h3 No events found.
    =link_to "Add an event!", new_occasion_event_path(@occasion)